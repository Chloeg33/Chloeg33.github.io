<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport"
        content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Academic Vocabulary Test | Chloe's Classroom Space Station</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="css/style.css">
    <!-- Firebase SDK 引入 -->
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-database-compat.js"></script>
    <style>
        /* 测验特定样式 */
        .question {
            margin: 20px 0;
            background-color: var(--apple-card);
            padding: 20px;
            border-radius: var(--apple-radius);
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.08);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }

        .question:hover {
            transform: translateY(-2px);
            box-shadow: 0 12px 36px rgba(0, 0, 0, 0.12);
        }

        .question p {
            margin: 0 0 15px 0;
            font-size: 1.05rem;
            font-weight: 500;
            color: var(--apple-text);
        }

        label {
            display: block;
            margin: 10px 0;
            padding: 12px;
            background: #fff;
            border: 1px solid var(--apple-border);
            border-radius: var(--apple-radius-sm);
            cursor: pointer;
            transition: background 0.2s, border-color 0.2s;
        }

        label:hover {
            background: rgba(147, 112, 219, 0.05);
            border-color: var(--main-pink);
        }

        input[type="radio"] {
            margin-right: 10px;
            transform: scale(1.2);
        }

        input[type="text"] {
            width: 100%;
            padding: 12px;
            margin: 8px 0;
            border: 1px solid var(--apple-border);
            border-radius: var(--apple-radius-sm);
            font-size: 1rem;
            transition: border-color 0.3s, box-shadow 0.3s;
        }

        input[type="text"]:focus {
            border-color: var(--main-pink);
            box-shadow: 0 0 0 2px rgba(255, 107, 158, 0.2);
            outline: none;
        }

        .vocabulary-container {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 10px;
            margin: 20px 0;
            position: relative;
            z-index: 5;
        }

        .vocabulary-item {
            background: white;
            border: 1px solid var(--apple-border);
            border-radius: var(--apple-radius-sm);
            padding: 10px 15px;
            font-size: 0.95rem;
            text-align: center;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
            transition: all 0.2s;
            cursor: pointer;
            display: inline-block;
        }

        .vocabulary-item:hover {
            background: rgba(147, 112, 219, 0.05);
            border-color: var(--main-pink);
            transform: translateY(-2px);
            box-shadow: 0 3px 5px rgba(0, 0, 0, 0.15);
        }

        .vocabulary-item:active {
            transform: translateY(0);
        }

        .submit-btn {
            width: 100%;
            padding: 15px;
            background: linear-gradient(to right, var(--main-pink), var(--main-purple));
            color: white;
            border: none;
            border-radius: var(--apple-radius);
            cursor: pointer;
            font-size: 1.1rem;
            margin-top: 30px;
            transition: background-color 0.3s, transform 0.2s;
            box-shadow: 0 4px 12px rgba(255, 107, 158, 0.3);
            font-weight: 500;
        }

        .submit-btn:hover {
            background: linear-gradient(to right, #ff5a93, #8a63d2);
            transform: translateY(-2px);
            box-shadow: 0 6px 16px rgba(255, 107, 158, 0.4);
        }

        .submit-btn:active {
            transform: translateY(0);
        }

        #result {
            margin-top: 30px;
            padding: 20px;
            font-size: 1.1rem;
            text-align: center;
            border-radius: var(--apple-radius);
            background: rgba(147, 112, 219, 0.05);
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.08);
            transition: all 0.5s;
            display: none;
        }

        #result.show {
            display: block;
            animation: fadeIn 0.5s;
        }

        #result h3 {
            color: var(--main-pink);
            margin-top: 0;
            font-weight: 600;
        }

        .progress-bar {
            height: 10px;
            border-radius: 5px;
            background: var(--apple-border);
            margin-top: 5px;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            border-radius: 5px;
            background: linear-gradient(to right, var(--main-pink), var(--main-purple));
            transition: width 1s;
        }

        .return-btn {
            padding: 12px 25px;
            background: linear-gradient(to right, var(--main-pink), var(--main-purple));
            color: white;
            border: none;
            border-radius: var(--apple-radius);
            cursor: pointer;
            font-size: 1rem;
            margin-top: 20px;
            transition: background-color 0.3s, transform 0.2s;
            box-shadow: 0 4px 12px rgba(255, 107, 158, 0.3);
            display: inline-block;
            font-weight: 500;
        }

        .return-btn:hover {
            background: linear-gradient(to right, #ff5a93, #8a63d2);
            transform: translateY(-2px);
            box-shadow: 0 6px 16px rgba(255, 107, 158, 0.4);
        }

        /* 欢迎模态框样式 */
        .welcome-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.7);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 9999;
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s;
        }

        .welcome-modal.show {
            opacity: 1;
            visibility: visible;
        }

        .welcome-content {
            background: white;
            padding: 30px;
            border-radius: var(--apple-radius);
            width: 90%;
            max-width: 500px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
            text-align: center;
            transform: translateY(20px);
            transition: transform 0.3s;
        }

        .welcome-modal.show .welcome-content {
            transform: translateY(0);
        }

        .welcome-content h2 {
            color: var(--main-pink);
            margin-bottom: 20px;
            font-weight: 600;
        }

        .nickname-input {
            width: 100%;
            padding: 15px;
            margin: 20px 0;
            border: 1px solid var(--apple-border);
            border-radius: var(--apple-radius-sm);
            font-size: 1.1rem;
            text-align: center;
        }

        .nickname-input:focus {
            border-color: var(--main-pink);
            box-shadow: 0 0 0 2px rgba(255, 107, 158, 0.2);
            outline: none;
        }

        .start-btn {
            padding: 12px 40px;
            background: linear-gradient(to right, var(--main-pink), var(--main-purple));
            color: white;
            border: none;
            border-radius: var(--apple-radius);
            cursor: pointer;
            font-size: 1.1rem;
            transition: all 0.3s;
            box-shadow: 0 4px 12px rgba(255, 107, 158, 0.3);
            font-weight: 500;
        }

        .start-btn:hover {
            background: linear-gradient(to right, #ff5a93, #8a63d2);
            transform: translateY(-2px);
            box-shadow: 0 6px 16px rgba(255, 107, 158, 0.4);
        }

        /* 排行榜样式 */
        .leaderboard {
            margin-top: 30px;
            background: white;
            border-radius: var(--apple-radius);
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.08);
            overflow: hidden;
        }

        .leaderboard-header {
            background: linear-gradient(to right, var(--main-pink), var(--main-purple));
            color: white;
            padding: 15px 20px;
            font-weight: 600;
            font-size: 1.2rem;
            text-align: center;
        }

        .leaderboard-item {
            display: flex;
            align-items: center;
            padding: 15px 20px;
            border-bottom: 1px solid var(--apple-border);
            transition: background 0.2s;
        }

        .leaderboard-item:last-child {
            border-bottom: none;
        }

        .leaderboard-item:hover {
            background: rgba(147, 112, 219, 0.05);
        }

        .leaderboard-rank {
            font-weight: 600;
            font-size: 1.2rem;
            width: 40px;
            text-align: center;
        }

        .leaderboard-name {
            flex: 1;
            padding: 0 15px;
            font-weight: 500;
        }

        .leaderboard-score {
            font-weight: 600;
            color: var(--main-pink);
            width: 80px;
            text-align: right;
        }

        .leaderboard-accuracy {
            width: 100px;
            text-align: right;
            padding-left: 10px;
        }

        .user-highlight {
            background: rgba(255, 107, 158, 0.1);
            border-left: 3px solid var(--main-pink);
        }

        /* 排行榜查看按钮 */
        .view-leaderboard-btn {
            background: transparent;
            color: var(--main-pink);
            border: 1px solid var(--main-pink);
            padding: 10px 20px;
            border-radius: var(--apple-radius-sm);
            margin-left: 10px;
            cursor: pointer;
            transition: all 0.3s;
        }

        .view-leaderboard-btn:hover {
            background: rgba(255, 107, 158, 0.1);
        }

        .btn-container {
            display: flex;
            justify-content: center;
            flex-wrap: wrap;
            gap: 10px;
            margin-top: 20px;
        }

        /* 动画效果 */
        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(20px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        /* 移动端优化 */
        @media (max-width: 768px) {
            .question {
                padding: 15px;
            }

            .vocabulary-container {
                gap: 8px;
            }

            .vocabulary-item {
                padding: 8px 12px;
                font-size: 0.9rem;
            }

            .btn-container {
                flex-direction: column;
            }

            .return-btn,
            .view-leaderboard-btn {
                width: 100%;
                margin: 5px 0;
            }
        }

        @media (max-width: 576px) {
            .vocabulary-container {
                display: flex;
                flex-wrap: wrap;
                justify-content: center;
                gap: 8px;
            }

            .vocabulary-item {
                flex: 0 0 calc(45% - 10px);
                padding: 10px 8px;
                font-size: 0.9rem;
            }

            .leaderboard-accuracy {
                display: none;
            }
        }

        /* 加载中动画 */
        .loader {
            border: 5px solid #f3f3f3;
            border-top: 5px solid var(--main-pink);
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
            margin: 20px auto;
        }

        @keyframes spin {
            0% {
                transform: rotate(0deg);
            }

            100% {
                transform: rotate(360deg);
            }
        }

        .server-status {
            text-align: center;
            color: #666;
            margin: 10px 0;
            font-size: 0.9rem;
        }

        .status-badge {
            display: inline-block;
            padding: 2px 8px;
            border-radius: 10px;
            font-size: 0.8rem;
            margin-left: 5px;
        }

        .status-online {
            background-color: #d4edda;
            color: #155724;
        }

        .status-offline {
            background-color: #f8d7da;
            color: #721c24;
        }

        .retry-btn {
            background: transparent;
            border: 1px solid var(--main-pink);
            color: var(--main-pink);
            padding: 5px 10px;
            border-radius: var(--apple-radius-sm);
            font-size: 0.9rem;
            cursor: pointer;
            transition: all 0.2s;
        }

        .retry-btn:hover {
            background: rgba(255, 107, 158, 0.1);
        }

        /* 全局消息通知 */
        .toast-message {
            position: fixed;
            top: 20px;
            right: 20px;
            max-width: 350px;
            background: white;
            border-left: 4px solid var(--main-pink);
            border-radius: var(--apple-radius-sm);
            padding: 15px 20px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
            z-index: 9999;
            opacity: 0;
            visibility: hidden;
            transform: translateY(-20px);
            transition: all 0.3s;
        }

        .toast-message.show {
            opacity: 1;
            visibility: visible;
            transform: translateY(0);
        }

        .toast-message.success {
            border-left-color: #28a745;
        }

        .toast-message.error {
            border-left-color: #dc3545;
        }
    </style>
</head>

<body>
    <!-- 全局消息通知 -->
    <div class="toast-message" id="toastMessage"></div>

    <!-- 欢迎输入昵称模态框 -->
    <div class="welcome-modal show" id="welcomeModal">
        <div class="welcome-content">
            <h2>欢迎参加学术词汇挑战赛</h2>
            <p>请输入您的昵称开始答题</p>
            <input type="text" class="nickname-input" id="nicknameInput" placeholder="输入您的昵称" maxlength="20">
            <button class="start-btn" onclick="startQuiz()">开始挑战</button>
        </div>
    </div>

    <!-- Navigation Bar -->
    <nav class="navbar navbar-expand-lg navbar-light fixed-top">
        <div class="container">
            <a class="navbar-brand" href="index.html">Chloe's Classroom Space Station</a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav ms-auto">
                    <li class="nav-item">
                        <a class="nav-link" href="index.html">Home</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link active" href="quizzes.html">Interactive Quizzes</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="games.html">English Games</a>
                    </li>
                </ul>
            </div>
        </div>
    </nav>

    <!-- Main Content -->
    <header class="text-white text-center">
        <div class="container">
            <h1>Academic Vocabulary Test</h1>
            <p class="lead">Test your knowledge of academic English vocabulary</p>
            <div id="userWelcome" class="mt-3" style="display: none;">
                <span class="badge bg-light text-dark p-2">参赛选手: <span id="displayNickname"></span></span>
            </div>
        </div>
    </header>

    <section>
        <div class="container">
            <div class="card" id="quizCard">
                <div class="card-body">
                    <form id="quizForm">
                        <!-- 选择题部分 -->
                        <h2 class="card-title">Multiple Choice Questions (20 points)</h2>

                        <div class="question">
                            <p>1. The research paper offers a comprehensive ________ of the factors contributing to
                                urban
                                sprawl.</p>
                            <label><input type="radio" name="q1" value="A"> A) formula</label>
                            <label><input type="radio" name="q1" value="B"> B) analysis</label>
                            <label><input type="radio" name="q1" value="C"> C) procedure</label>
                            <label><input type="radio" name="q1" value="D"> D) context</label>
                        </div>

                        <div class="question">
                            <p>2. Policymakers are considering a new ________ to mitigate the adverse effects of climate
                                change
                                on
                                coastal communities.</p>
                            <label><input type="radio" name="q2" value="A"> A) component</label>
                            <label><input type="radio" name="q2" value="B"> B) approach</label>
                            <label><input type="radio" name="q2" value="C"> C) opponent</label>
                            <label><input type="radio" name="q2" value="D"> D) structure</label>
                        </div>

                        <div class="question">
                            <p>3. Further investigation is needed to determine the specific ________ of the brain
                                exhibiting
                                abnormal neural activity during the task.</p>
                            <label><input type="radio" name="q3" value="A"> A) binary</label>
                            <label><input type="radio" name="q3" value="B"> B) area</label>
                            <label><input type="radio" name="q3" value="C"> C) adaptive</label>
                            <label><input type="radio" name="q3" value="D"> D) process</label>
                        </div>

                        <div class="question">
                            <p>4. A thorough ________ of the proposed intervention strategy will be conducted to
                                evaluate its
                                feasibility and effectiveness.</p>
                            <label><input type="radio" name="q4" value="A"> A) distribution</label>
                            <label><input type="radio" name="q4" value="B"> B) interpretation</label>
                            <label><input type="radio" name="q4" value="C"> C) definition</label>
                            <label><input type="radio" name="q4" value="D"> D) assessment</label>
                        </div>

                        <div class="question">
                            <p>5. We ________ that the observed correlation between socioeconomic status and academic
                                achievement
                                warrants further investigation into causal mechanisms.</p>
                            <label><input type="radio" name="q5" value="A"> A) certain</label>
                            <label><input type="radio" name="q5" value="B"> B) assume</label>
                            <label><input type="radio" name="q5" value="C"> C) create</label>
                            <label><input type="radio" name="q5" value="D"> D) simplify</label>
                        </div>

                        <div class="question">
                            <p>6. Professor Klein is a recognized ________ in the domain of quantum physics, renowned
                                for his
                                groundbreaking contributions to string theory.</p>
                            <label><input type="radio" name="q6" value="A"> A) principle</label>
                            <label><input type="radio" name="q6" value="B"> B) authority</label>
                            <label><input type="radio" name="q6" value="C"> C) concept</label>
                            <label><input type="radio" name="q6" value="D"> D) evidence</label>
                        </div>

                        <div class="question">
                            <p>7. The complete dataset is ________ upon request for researchers affiliated with
                                accredited
                                academic
                                institutions.</p>
                            <label><input type="radio" name="q7" value="A"> A) consistent</label>
                            <label><input type="radio" name="q7" value="B"> B) available</label>
                            <label><input type="radio" name="q7" value="C"> C) economic</label>
                            <label><input type="radio" name="q7" value="D"> D) specific</label>
                        </div>

                        <div class="question">
                            <p>8. The revised curriculum is designed to ________ students from diverse linguistic and
                                cultural
                                backgrounds, fostering inclusivity and academic success.</p>
                            <label><input type="radio" name="q8" value="A"> A) benefit</label>
                            <label><input type="radio" name="q8" value="B"> B) derive</label>
                            <label><input type="radio" name="q8" value="C"> C) establish</label>
                            <label><input type="radio" name="q8" value="D"> D) estimate</label>
                        </div>

                        <div class="question">
                            <p>9. The overarching ________ of social justice, encompassing equity and human rights, is
                                central
                                to
                                contemporary political discourse.</p>
                            <label><input type="radio" name="q9" value="A"> A) context</label>
                            <label><input type="radio" name="q9" value="B"> B) variability</label>
                            <label><input type="radio" name="q9" value="C"> C) option</label>
                            <label><input type="radio" name="q9" value="D"> D) concept</label>
                        </div>

                        <div class="question">
                            <p>10. The experimental findings regarding the efficacy of the treatment are ________ with
                                meta-analytic
                                reviews of similar interventions.</p>
                            <label><input type="radio" name="q10" value="A"> A) similar</label>
                            <label><input type="radio" name="q10" value="B"> B) consistent</label>
                            <label><input type="radio" name="q10" value="C"> C) significant</label>
                            <label><input type="radio" name="q10" value="D"> D) major</label>
                        </div>

                        <div class="question">
                            <p>11. The ethical and ________ dimensions of artificial intelligence necessitate careful
                                consideration
                                of potential societal ramifications.</p>
                            <label><input type="radio" name="q11" value="A"> A) conditional</label>
                            <label><input type="radio" name="q11" value="B"> B) financial</label>
                            <label><input type="radio" name="q11" value="C"> C) legal</label>
                            <label><input type="radio" name="q11" value="D"> D) environmental</label>
                        </div>

                        <div class="question">
                            <p>12. To fully appreciate the theoretical underpinnings of the argument, it is imperative
                                to
                                examine
                                the intellectual ________ in which it emerged.</p>
                            <label><input type="radio" name="q12" value="A"> A) rule</label>
                            <label><input type="radio" name="q12" value="B"> B) context</label>
                            <label><input type="radio" name="q12" value="C"> C) structure</label>
                            <label><input type="radio" name="q12" value="D"> D) approach</label>
                        </div>

                        <div class="question">
                            <p>13. The two companies signed a ________ outlining the terms of their collaboration on the
                                project.
                            </p>
                            <label><input type="radio" name="q13" value="A"> A) contract</label>
                            <label><input type="radio" name="q13" value="B"> B) formula</label>
                            <label><input type="radio" name="q13" value="C"> C) law</label>
                            <label><input type="radio" name="q13" value="D"> D) procedure</label>
                        </div>

                        <div class="question">
                            <p>14. Researchers are planning to ________ a series of experiments to test the efficacy of
                                the new
                                drug.</p>
                            <label><input type="radio" name="q14" value="A"> A) create</label>
                            <label><input type="radio" name="q14" value="B"> B) achieve</label>
                            <label><input type="radio" name="q14" value="C"> C) obtain</label>
                            <label><input type="radio" name="q14" value="D"> D) conduct</label>
                        </div>

                        <div class="question">
                            <p>15. The ________ collected from the experiment will be used to test the hypothesis.</p>
                            <label><input type="radio" name="q15" value="A"> A) data</label>
                            <label><input type="radio" name="q15" value="B"> B) evidence</label>
                            <label><input type="radio" name="q15" value="C"> C) variables</label>
                            <label><input type="radio" name="q15" value="D"> D) factors</label>
                        </div>

                        <div class="question">
                            <p>16. A precise ________ of the term 'globalization' is essential for academic discourse.
                            </p>
                            <label><input type="radio" name="q16" value="A"> A) interpretation</label>
                            <label><input type="radio" name="q16" value="B"> B) analysis</label>
                            <label><input type="radio" name="q16" value="C"> C) definition</label>
                            <label><input type="radio" name="q16" value="D"> D) assessment</label>
                        </div>

                        <div class="question">
                            <p>17. The therapeutic intervention is ________ from principles of cognitive behavioral
                                therapy and
                                mindfulness-based stress reduction.</p>
                            <label><input type="radio" name="q17" value="A"> A) derived</label>
                            <label><input type="radio" name="q17" value="B"> B) identified</label>
                            <label><input type="radio" name="q17" value="C"> C) indicated</label>
                            <label><input type="radio" name="q17" value="D"> D) established</label>
                        </div>

                        <div class="question">
                            <p>18. The study investigates the spatial ________ of economic opportunities across urban
                                and rural
                                landscapes.</p>
                            <label><input type="radio" name="q18" value="A"> A) distribution</label>
                            <label><input type="radio" name="q18" value="B"> B) export</label>
                            <label><input type="radio" name="q18" value="C"> C) income</label>
                            <label><input type="radio" name="q18" value="D"> D) investment</label>
                        </div>

                        <div class="question">
                            <p>19. The prevailing ________ paradigm in macroeconomic theory posits rational expectations
                                and
                                market
                                equilibrium.</p>
                            <label><input type="radio" name="q19" value="A"> A) financial</label>
                            <label><input type="radio" name="q19" value="B"> B) labour</label>
                            <label><input type="radio" name="q19" value="C"> C) legal</label>
                            <label><input type="radio" name="q19" value="D"> D) economic</label>
                        </div>

                        <div class="question">
                            <p>20. The conservation initiative aims to safeguard the fragile ________ and biodiversity
                                of the
                                Amazon
                                rainforest.</p>
                            <label><input type="radio" name="q20" value="A"> A) sector</label>
                            <label><input type="radio" name="q20" value="B"> B) environment</label>
                            <label><input type="radio" name="q20" value="C"> C) area</label>
                            <label><input type="radio" name="q20" value="D"> D) method</label>
                        </div>

                        <!-- 填空题部分 -->
                        <h2 class="card-title mt-5">Sentence Completion (10 points)</h2>
                        <p>选择以下单词填空：</p>

                        <!-- 现代化词汇标签设计 -->
                        <div class="vocabulary-container">
                            <div class="vocabulary-item">statistically</div>
                            <div class="vocabulary-item">combination</div>
                            <div class="vocabulary-item">include</div>
                            <div class="vocabulary-item">acknowledged</div>
                            <div class="vocabulary-item">primary</div>
                            <div class="vocabulary-item">increase</div>
                            <div class="vocabulary-item">foundation</div>
                            <div class="vocabulary-item">analysis</div>
                            <div class="vocabulary-item">rate</div>
                            <div class="vocabulary-item">instructions</div>
                        </div>

                        <div class="question">
                            <p>21. The __________ objective of this study is to examine the impact of social media on
                                adolescent
                                mental health.</p>
                            <input type="text" name="q21" placeholder="Type or click a word above">
                        </div>

                        <div class="question">
                            <p>22. The final phase of the experiment involves rigorous statistical _________ of the
                                collected
                                data.
                            </p>
                            <input type="text" name="q22" placeholder="Type or click a word above">
                        </div>

                        <div class="question">
                            <p>23. The observed ___________ in student engagement was a positive outcome of the
                                pedagogical
                                innovation.</p>
                            <input type="text" name="q23" placeholder="Type or click a word above">
                        </div>

                        <div class="question">
                            <p>24. The previous research on this topic provides a crucial _________ for understanding
                                the
                                current
                                state of knowledge.</p>
                            <input type="text" name="q24" placeholder="Type or click a word above">
                        </div>

                        <div class="question">
                            <p>25. It is relevant to ___________ detailed methodological information in the appendix of
                                the
                                research
                                paper.</p>
                            <input type="text" name="q25" placeholder="Type or click a word above">
                        </div>

                        <div class="question">
                            <p>26. The potential benefits of early childhood education are widely ___________ in
                                developmental
                                psychology.</p>
                            <input type="text" name="q26" placeholder="Type or click a word above">
                        </div>

                        <div class="question">
                            <p>27. The etiology of the disorder is highly complex, involving a ___________ of genetic
                                and
                                environmental factors.</p>
                            <input type="text" name="q27" placeholder="Type or click a word above">
                        </div>

                        <div class="question">
                            <p>28. Under normal laboratory conditions, the chemical reaction proceeds at a predictable
                                _________.
                            </p>
                            <input type="text" name="q28" placeholder="Type or click a word above">
                        </div>

                        <div class="question">
                            <p>29. The findings are ___________ significant, suggesting a genuine effect rather than
                                random
                                variation.</p>
                            <input type="text" name="q29" placeholder="Type or click a word above">
                        </div>

                        <div class="question">
                            <p>30. For specific ___________ on data collection, please refer to section 3.2 of the
                                manual.</p>
                            <input type="text" name="q30" placeholder="Type or click a word above">
                        </div>

                        <button type="button" class="submit-btn" onclick="calculateScore()">提交答案</button>
                    </form>

                    <div id="result"></div>
                </div>
            </div>

            <!-- 排行榜卡片 -->
            <div class="card mt-4" id="leaderboardCard" style="display: none;">
                <div class="card-body">
                    <h2 class="card-title text-center">Academic Vocabulary 竞赛排行榜</h2>

                    <!-- 服务器状态 -->
                    <div class="server-status" id="serverStatus">
                        后端服务状态：<span class="status-badge status-offline">正在连接...</span>
                        <button class="retry-btn" id="retryButton" style="display: none;">重试连接</button>
                    </div>

                    <div class="leaderboard">
                        <div class="leaderboard-header">
                            <div class="row">
                                <div class="col-2">排名</div>
                                <div class="col-5">昵称</div>
                                <div class="col-2">分数</div>
                                <div class="col-3 d-none d-md-block">准确率</div>
                            </div>
                        </div>
                        <div id="leaderboardItems">
                            <!-- 排行榜内容将由JS动态生成 -->
                            <div class="loader" id="leaderboardLoader"></div>
                        </div>
                    </div>
                    <div class="text-center mt-4">
                        <button class="return-btn" onclick="showQuizResult()">返回我的成绩</button>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Footer -->
    <footer class="py-4 text-white">
        <div class="container text-center">
            <p>Designed with ❤️ by Chloe | © 2025 All Rights Reserved</p>
        </div>
    </footer>

    <script>
        const encodedMcqAnswers = "QixCLEIsRCxCLEIsQixBLEQsQixDLEIsQSxELEEsQyxBLEEsRCxC";
        const encodedFillAnswers = "cHJpbWFyeSxhbmFseXNpcyxpbmNyZWFzZSxmb3VuZGF0aW9uLGluY2x1ZGUsYWNrbm93bGVkZ2VkLGNvbWJpbmF0aW9uLHJhdGUsc3RhdGlzdGljYWxseSxpbnN0cnVjdGlvbnM=";

        // 存储用户昵称
        let userNickname = "";
        // 存储用户分数
        let userScore = 0;
        let userAccuracy = 0;
        // Firebase引用
        let db;
        let connected = false;

        // Firebase配置
        const firebaseConfig = {
            apiKey: "AIzaSyAOKe0n9obzJPDzCXbyEDpIINSJ3womdq0",
            authDomain: "chloe-fc03a.firebaseapp.com",
            databaseURL: "https://chloe-fc03a-default-rtdb.firebaseio.com",
            projectId: "chloe-fc03a",
            storageBucket: "chloe-fc03a.firebasestorage.app",
            messagingSenderId: "748571719604",
            appId: "1:748571719604:web:a24187ed08b20d9566e4e1"
        };

        // 初始化Firebase
        function initFirebase() {
            try {
                // 初始化Firebase
                firebase.initializeApp(firebaseConfig);
                // 获取数据库引用
                db = firebase.database();

                // 检查连接状态
                const connectedRef = db.ref(".info/connected");
                connectedRef.on("value", (snap) => {
                    connected = snap.val() === true;
                    updateServerStatus();
                });

                showToast("后端服务已连接", "success");
                console.log("Firebase初始化成功");
            } catch (error) {
                console.error("Firebase初始化失败:", error);
                showToast("无法连接到后端服务", "error");
                connected = false;
                updateServerStatus();
            }
        }

        // 更新服务器状态显示
        function updateServerStatus() {
            const statusElement = document.querySelector("#serverStatus .status-badge");
            const retryButton = document.getElementById("retryButton");

            if (connected) {
                statusElement.textContent = "在线";
                statusElement.className = "status-badge status-online";
                retryButton.style.display = "none";
            } else {
                statusElement.textContent = "离线";
                statusElement.className = "status-badge status-offline";
                retryButton.style.display = "inline-block";
            }
        }

        // 显示通知消息
        function showToast(message, type = "info") {
            const toast = document.getElementById("toastMessage");
            toast.textContent = message;
            toast.className = "toast-message show " + type;

            // 3秒后自动隐藏
            setTimeout(() => {
                toast.className = "toast-message";
            }, 3000);
        }

        // 模拟的排行榜数据（仅在无法连接到Firebase时使用）
        const mockLeaderboard = [
            { nickname: "学霸王", score: 28, accuracy: 93.3 },
            { nickname: "词汇达人", score: 27, accuracy: 90.0 },
            { nickname: "英语小天才", score: 25, accuracy: 83.3 },
            { nickname: "考试之王", score: 24, accuracy: 80.0 },
            { nickname: "知识海绵", score: 23, accuracy: 76.7 },
            { nickname: "学习机器", score: 21, accuracy: 70.0 },
            { nickname: "努力的小白", score: 19, accuracy: 63.3 },
            { nickname: "小小探索者", score: 18, accuracy: 60.0 },
            { nickname: "潜力无限", score: 17, accuracy: 56.7 },
            { nickname: "进步之星", score: 15, accuracy: 50.0 }
        ];

        // 获取排行榜数据
        function fetchLeaderboard() {
            document.getElementById("leaderboardLoader").style.display = "block";

            if (!connected || !db) {
                // 如果未连接到Firebase，使用本地数据
                document.getElementById("leaderboardLoader").style.display = "none";
                renderLeaderboard(getLocalLeaderboard());
                return;
            }

            let score = 0;
            let mcqScore = 0;
            let fillScore = 0;

            try {
                const mcqAnswers = decodeAnswers(encodedMcqAnswers);
                const fillAnswers = decodeAnswers(encodedFillAnswers);

                // 计算选择题得分
                for (let i = 0; i < 20; i++) {
                    const selected = document.querySelector(`input[name="q${i + 1}"]:checked`);
                    if (selected && selected.value === mcqAnswers[i]) {
                        score++;
                        mcqScore++;
                    }
                }

                // 计算填空题得分
                for (let i = 0; i < 10; i++) {
                    const answer = document.querySelector(`input[name="q${21 + i}"]`).value.toLowerCase().trim();
                    if (answer === fillAnswers[i]) {
                        score++;
                        fillScore++;
                    }
                }

                // 计算准确率
                userScore = score;
                userAccuracy = (score / 30) * 100;

                // 添加到排行榜
                addToLeaderboard(userNickname, userScore, userAccuracy);

                // 获取用户排名
                const userRank = getUserRank(userNickname);

                // 显示结果
                const resultDiv = document.getElementById('result');
                resultDiv.innerHTML = `
                    <h3>测试结果</h3>
                    <p>选择题得分：${mcqScore}/20</p>
                    <div class="progress-bar"><div class="progress-fill" style="width:${mcqScore * 5}%"></div></div>
                    <p>填空题得分：${fillScore}/10</p>
                    <div class="progress-bar"><div class="progress-fill" style="width:${fillScore * 10}%"></div></div>
                    <p>总分：${score}/30</p>
                    <div class="progress-bar"><div class="progress-fill" style="width:${score / 30 * 100}%"></div></div>
                    <p class="mt-3">准确率：${(score / 30 * 100).toFixed(1)}%</p>
                    <p class="text-success fw-bold">您的排名：第 ${userRank} 名</p>
                    <div class="btn-container">
                        <button onclick="window.location.href='quizzes.html'" class="return-btn">返回测验列表</button>
                        <button onclick="showLeaderboard()" class="view-leaderboard-btn">查看排行榜</button>
                    </div>
                `;

                resultDiv.classList.add('show');
                resultDiv.scrollIntoView({ behavior: 'smooth' });
            } catch (e) {
                alert('提交失败，请重试');
            }
        }

        // 添加选词填空功能
        document.addEventListener('DOMContentLoaded', function () {
            // 为词汇项添加点击事件
            const vocabularyItems = document.querySelectorAll('.vocabulary-item');
            let activeInput = null;

            // 为所有填空题输入框添加焦点事件
            const fillInputs = document.querySelectorAll('input[type="text"][name^="q2"]');
            fillInputs.forEach(input => {
                input.addEventListener('focus', function () {
                    activeInput = this;
                });
            });

            // 为词汇项添加点击事件
            vocabularyItems.forEach(item => {
                item.addEventListener('click', function () {
                    if (activeInput) {
                        activeInput.value = this.textContent;
                        // 查找下一个输入框并聚焦
                        const currentIndex = Array.from(fillInputs).indexOf(activeInput);
                        if (currentIndex < fillInputs.length - 1) {
                            fillInputs[currentIndex + 1].focus();
                        }
                    } else if (fillInputs.length > 0) {
                        // 如果没有活动输入框，则默认选择第一个
                        fillInputs[0].focus();
                        fillInputs[0].value = this.textContent;
                    }
                });
            });

            // 添加按键导航
            document.addEventListener('keydown', function (e) {
                if (!activeInput) return;

                const currentIndex = Array.from(fillInputs).indexOf(activeInput);

                // Tab 键已经有默认行为，处理上下左右键
                if (e.key === 'ArrowDown' || e.key === 'ArrowRight') {
                    e.preventDefault();
                    if (currentIndex < fillInputs.length - 1) {
                        fillInputs[currentIndex + 1].focus();
                    }
                } else if (e.key === 'ArrowUp' || e.key === 'ArrowLeft') {
                    e.preventDefault();
                    if (currentIndex > 0) {
                        fillInputs[currentIndex - 1].focus();
                    }
                }
            });

            // 处理回车键在昵称输入时提交
            document.getElementById('nicknameInput').addEventListener('keydown', function (e) {
                if (e.key === 'Enter') {
                    e.preventDefault();
                    startQuiz();
                }
            });

            // 如果本地存储中有昵称，则自动填充
            const savedNickname = localStorage.getItem('quizUserNickname');
            if (savedNickname) {
                document.getElementById('nicknameInput').value = savedNickname;
            }
        });
    </script>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="js/main.js"></script>
</body>

</html>